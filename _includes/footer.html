 = 'none';
      preBlock.style.backgroundColor = 'initial';
    });
  })()
    </script>

    {% if page.sequence %}
    <script src="{{ assets_base_url }}/assets/js/webfont.js"></script>
    <script src="{{ assets_base_url }}/assets/js/snap.svg-min.js"></script>
    <script src="https://fastly.jsdelivr.net/npm/underscore@1.13.1/underscore-umd-min.js"></script>
    <script src="{{ assets_base_url }}/assets/vendor/js-sequence-diagrams/dist/sequence-diagram-min.js"></script>
    <link rel="stylesheet" href="{{ assets_base_url }}/assets/vendor/js-sequence-diagrams/dist/sequence-diagram-min.css">
    <script>
      $(".language-sequence").sequenceDiagram({theme: 'simple'});
    </script>
    {% endif %}

    {% if page.flow %}
    <script src="{{ assets_base_url }}/assets/js/raphael.min.js"></script>
    <script src="{{ assets_base_url }}/assets/vendor/flowchart.js/dist/flowchart.min.js"></script>
    <script src="{{ assets_base_url }}/assets/js/flow.js"></script>
    {% endif %}

    {% if page.mathjax %}
    <script type="text/javascript" src="https://fastly.jsdelivr.net/gh/mathjax/MathJax@2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    {% endif %}

    {% if page.mindmap %}
    <link rel="stylesheet" href="https://fastly.jsdelivr.net/gh/mzlogin/kityminder-core@dev/dist/kityminder.core.css">
    <script type="text/javascript" src="https://fastly.jsdelivr.net/gh/mzlogin/kity@dev/dist/kity.min.js"></script>
    <script type="text/javascript" src="https://fastly.jsdelivr.net/gh/mzlogin/kityminder-core@dev/dist/kityminder.core.min.js"></script>
    <script>
$(document).ready(function(){
  $('.language-mindmap').each(function(index, element) {
    var markdownText = element.textContent.trim();
    var parentNode = element.parentNode.parentNode;
    var nodeName = '.language-mindmap-' + index;
    var node = document.createElement("div");
    node.className = 'language-mindmap-' + index;
    node.style.height = '' + $(element).height() + 'px';
    parentNode.insertBefore(node, element.parentNode);
    var minder = new kityminder.Minder({
      renderTo: nodeName
    });
    minder.importData('markdown', markdownText);
    /* minder.disable(); */
    minder.execCommand('hand');

    var viewerTipNode = document.createElement("a");
    viewerTipNode.setAttribute('href', '{{ site.url }}/mindmap-viewer/?data=' + encodeURIComponent(markdownText));
    viewerTipNode.setAttribute('target', '_blank');
    viewerTipNode.setAttribute('style', 'font-size:0.8rem;font-style:italic;font-color:grey;');
    viewerTipNode.innerText = 'å…¨å±æŸ¥çœ‹';
    parentNode.insertBefore(viewerTipNode, element.parentNode);

    element.parentNode.style.display = 'none';

    {% if page.mindmap-template %}
    setTimeout(function() {
      minder.setTemplate('{{ page.mindmap-template }}');
      minder.refresh();
    }, 100);
    {% endif %}
  });
});
    </script>
    {% endif %}
{% if page.mindmap2 %}
    <script src="https://fastly.jsdelivr.net/npm/d3@6"></script>
    <script src="https://fastly.jsdelivr.net/npm/markmap-view"></script>
    <script src="https://fastly.jsdelivr.net/npm/markmap-autoloader@0.1.2/dist/index.min.js"></script>
    <style>
        .markmap > svg {
          width: 100%;
          height: 100%;
          background: rgba(255, 255, 255, 0.9);
        }
    </style>
    <script>
        function fullScreen(nodeId) {
            var element= document.getElementById(nodeId);  
            if (window.ActiveXObject) {
                var WsShell = new ActiveXObject('WScript.Shell');
                WsShell.SendKeys('{F11}');
            }
            else if (element.requestFullScreen) {
                element.requestFullScreen();
            }
            else if (element.msRequestFullscreen) {
                element.msRequestFullscreen();
            }
            else if (element.webkitRequestFullScreen) {
                element.webkitRequestFullScreen();
            }
            else if (element.mozRequestFullScreen) {
                element.mozRequestFullScreen();
            }
        }

        function fullExit() {
            var element= document.getElementById("ddd");  
            if (window.ActiveXObject) {
                var WsShell = new ActiveXObject('WScript.Shell');
                WsShell.SendKeys('{F11}');
            }
            else if (element.requestFullScreen) {
                document.exitFullscreen();
            }
            else if (element.msRequestFullscreen) {
                document.msExitFullscreen();
            }
            else if (element.webkitRequestFullScreen) {
                document.webkitCancelFullScreen();
            }
            else if (element.mozRequestFullScreen) {
                document.mozCancelFullScreen();
            }
        }

        function insertAfter(newElement, targetElement) {
            var parent = targetElement.parentNode;
            if (parent.lastChild == targetElement) {
                parent.appendChild(targetElement);
            } else {
                parent.insertBefore(newElement, targetElement.nextSibling);
            }
        }
       
        $(document).ready(function(){
            $('.language-mindmap').each(function(index, element) {
                window.markmap = {
                    autoLoader: { manual: false },
                };
                var markdownText = element.textContent.trim();
                var parentNode = element.parentNode.parentNode;
                element.setAttribute('class', "markmap");
                var nodeName = '.language-mindmap-' + index;
                element.setAttribute("id", nodeName);
                var viewerTipNode1 = document.createElement("a");
                viewerTipNode1.appendChild(document.createTextNode("å…¨å±"));
                viewerTipNode1.setAttribute('onclick', 'fullScreen("' + nodeName + '")');
                viewerTipNode1.setAttribute('style', 'font-size:0.8rem;font-style:italic;font-color:grey;');
                viewerTipNode1.setAttribute('href', 'javascript:void(0)');
                insertAfter(viewerTipNode1, element.parentNode);
                var viewerTipNode2 = document.createElement("a");
                viewerTipNode2.appendChild(document.createTextNode("è¯­æ³•æç¤º"));
                viewerTipNode2.setAttribute('href', 'https://markmap.js.org/');
                viewerTipNode2.setAttribute('target', '_blank');
                viewerTipNode2.setAttribute('style', 'font-size:0.8rem;font-style:italic;font-color:grey;padding-left:0.5rem;');
                insertAfter(viewerTipNode2, viewerTipNode1);
            });
        });
    </script>      
{% endif %}

<!-- é…ç½® Live2D çœ‹æ¿å¨˜æ¨¡å‹ï¼ˆå¿…é¡»æ”¾åœ¨ autoload.js ä¹‹å‰ï¼‰ -->
<script>
window.live2d_widgets = {
  // æ¨¡å‹è·¯å¾„ï¼ˆæ ¹æ®ä»“åº“ç»“æ„è°ƒæ•´ï¼Œå‡è®¾â€œæ¥æºâ€å¯¹åº”â€œmodelsâ€ç›®å½•ï¼‰
  modelPath: "https://fastly.jsdelivr.net/npm/live2d-widgets@1.0.0-rc.6/models/neko/", 
// è§£é‡Šï¼š  
// - "https://fastly.jsdelivr.net/"ï¼šJSDelivr CDNï¼ŒåŠ é€Ÿæ¨¡å‹åŠ è½½ï¼›  
// - "npm/live2d-widgets@1.0.0-rc.6"ï¼šæŒ‡å®šåº“çš„ç‰ˆæœ¬ï¼ˆé¿å…æ›´æ–°å¯¼è‡´é—®é¢˜ï¼‰ï¼›  
// - "models/neko/"ï¼šæ¨¡å‹æ–‡ä»¶çš„å®é™…ç›®å½•ï¼ˆnekoæ˜¯çŒ«å¨˜æ¨¡å‹ï¼Œæ²¡é”™ï¼ï¼‰ã€‚
  // æ˜¾ç¤ºé…ç½®ï¼ˆè°ƒæ•´ä½ç½®å’Œå¤§å°ï¼Œé€‚é…ä½ çš„åšå®¢ï¼‰
  display: {
  position: "fixed",      // â‘  å›ºå®šåœ¨å±å¹•è§†å£ï¼ˆå…³é”®ï¼åªæœ‰å›ºå®šæ‰èƒ½ç”¨right/bottomï¼‰ï¼›  
  right: 15,              // â‘¡ è·ç¦»å³è¾¹15pxï¼ˆä¸è´´è¾¹ï¼Œæ›´å¯çˆ±ï¼‰ï¼›  
  bottom: 25,             // â‘¢ è·ç¦»åº•éƒ¨25pxï¼ˆåˆšå¥½åœ¨å³ä¸‹è§’ï¼Œä¸æŒ¡å¯¼èˆªï¼‰ï¼›  
  left: "auto",           // â‘£ å–æ¶ˆå·¦è¾¹çš„å›ºå®šï¼ˆé¿å…å’Œrightå†²çªï¼Œå¿…é¡»å†™ï¼ï¼‰ï¼›  
  width: 160,             // â‘¤ çœ‹æ¿å¨˜å®½åº¦ï¼ˆ160pxåˆšå¥½ï¼Œä¸å å¤ªå¤šç©ºé—´ï¼‰ï¼›  
  height: 320,            // â‘¥ çœ‹æ¿å¨˜é«˜åº¦ï¼ˆ320pxï¼Œæ¯”ä¾‹åè°ƒï¼‰ï¼›  
  zIndex: 999999,         // â‘¦ å±‚çº§æ‹‰åˆ°æœ€é«˜ï¼ˆ999999ï¼‰ï¼Œä¸ä¼šè¢«ä»»ä½•å…ƒç´ ï¼ˆæ¯”å¦‚å¯¼èˆªã€å¡ç‰‡ï¼‰æŒ¡ä½ï¼›  
  transform: "none",      // â‘§ å–æ¶ˆé»˜è®¤çš„ç¼©æ”¾/å¹³ç§»ï¼ˆé¿å…ä½ç½®åç§»ï¼‰ï¼›  
},
  // ç§»åŠ¨ç«¯é€‚é…ï¼ˆç¡®ä¿æ‰‹æœºæ˜¾ç¤ºæ­£å¸¸ï¼‰
  mobile: {
  show: true,             // â‘  å¼ºåˆ¶åœ¨æ‰‹æœºç«¯æ˜¾ç¤ºï¼ˆé»˜è®¤å¯èƒ½éšè—ï¼Œå¿…é¡»å¼€ï¼ï¼‰ï¼›  
  scale: 0.75,            // â‘¡ ç¼©å°åˆ°75%ï¼ˆ160pxÃ—0.75=120pxï¼Œåˆšå¥½é€‚åˆæ‰‹æœºå±å¹•ï¼‰ï¼›  
  position: "fixed",      // â‘¢ æ‰‹æœºç«¯ä¹Ÿå›ºå®šåœ¨å³ä¸‹è§’ï¼›  
  right: 10,              // â‘£ æ‰‹æœºç«¯è·ç¦»å³è¾¹10pxï¼›  
  bottom: 15,             // â‘¤ æ‰‹æœºç«¯è·ç¦»åº•éƒ¨15pxï¼›  
},
};
</script>

{% if site.data.announcement.popup_enabled %}
{% assign announcement = site.data.announcement.announcements[0] %}
<div id="announcement-popup" class="announcement-popup"
     style="background: {{ announcement.background | default: '#fff9e6' }}; 
             color: {{ announcement.color | default: '#5a4a42' }};
             border: 2px solid {{ announcement.border_color | default: '#4CAF50' }};">
  <div class="popup-content">
    <h3 class="popup-title">{{ announcement.title | default: 'ğŸš§ åšå®¢æ–½å·¥ä¸­å–µï½' }}</h3>
    <div class="popup-text">
      {{ announcement.content | markdownify }}
    </div>
    <button id="close-popup" class="popup-btn"
            style="background: {{ announcement.button_bg | default: '#4CAF50' }}; 
                   color: {{ announcement.button_color | default: 'white' }};">
      {{ announcement.button_text | default: 'ç¡®è®¤å¹¶å…³é—­' }}
    </button>
  </div>
</div>

<style>
.announcement-popup {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  padding: 0;
  border-radius: 15px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.3);
  z-index: 99999;
  max-width: 90%;
  width: 400px;
  display: none;
  background: white;
}

.announcement-popup::before {
  content: '';
  position: fixed;
  top: 0; left: 0;
  width: 100vw; height: 100vh;
  background: rgba(0,0,0,0.5);
  z-index: -1;
}

.popup-content {
  padding: 20px;
}

.popup-title {
  margin-bottom: 15px;
  text-align: center;
  font-size: 1.2em;
  color: {{ announcement.title_color | default: '#4CAF50' }};
}

.popup-text {
  line-height: 1.6;
  margin-bottom: 20px;
}

.popup-btn {
  width: 100%;
  padding: 10px;
  border: none;
  border-radius: 5px;
  cursor: pointer;
  font-size: 16px;
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const popup = document.getElementById('announcement-popup');
  const closeBtn = document.getElementById('close-popup');
  
  if (popup && !localStorage.getItem('announcement-closed')) {
    popup.style.display = 'block';
    setTimeout(() => {
      popup.style.opacity = '1';
      popup.style.transform = 'translate(-50%, -50%) scale(1)';
    }, 100);
  }
  
  if (closeBtn) {
    closeBtn.addEventListener('click', function() {
      popup.style.display = 'none';
      localStorage.setItem('announcement-closed', 'true');
    });
  }
});
</script>
{% endif %}

<!-- é…ç½® Live2D çœ‹æ¿å¨˜æ¨¡å‹ -->
<script>
window.live2d_widgets = {
  modelPath: "https://cdn.jsdelivr.net/npm/live2d-widgets@1.0.0-rc.6/dist/models/neko/",
  display: {
    position: "fixed",
    right: 15,
    bottom: 25,
    left: "auto",
    width: 160,
    height: 320,
    zIndex: 999999,
    transform: "none",
  },
  mobile: {
    show: true,
    scale: 0.75,
    position: "fixed",
    right: 10,
    bottom: 15,
  },
};
</script>

<!-- åŠ è½½çœ‹æ¿å¨˜æ ¸å¿ƒè„šæœ¬ -->
<!-- è®°å¾—æŠŠ"é“¾æ¥1"æ¢æˆçœŸå®çš„URLå“¦å–µï½ -->
<script src="https://cdn.jsdelivr.net/npm/live2d-widgets@1.0.0-rc.6/dist/autoload.js"></script>

</body>
</html>
