<!-- ä¸è’œå­è®¿é—®ç»Ÿè®¡ - æ”¾ç½®åœ¨é¡µé¢æœ€åº•éƒ¨ -->
{% if site.components.busuanzi.enabled == true and page.visit-stat != 'hidden' and page.layout != 'mindmap' %}
<script async src="{{ assets_base_url }}/assets/vendor/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<div class="busuanzi-counter-container">
  <div class="busuanzi-counter-content">
    <span id="busuanzi_container_site_pv" class="busuanzi-stat">
      <span class="busuanzi-icon">ğŸ¾</span>
      <span class="busuanzi-label">æœ¬ç«™è®¿é—®é‡</span>
      <span id="busuanzi_value_site_pv" class="busuanzi-value">0</span>
      <span class="busuanzi-unit">æ¬¡</span>
    </span>
    
    <span class="busuanzi-separator">|</span>
    
    <span id="busuanzi_container_site_uv" class="busuanzi-stat">
      <span class="busuanzi-icon">ğŸ‘¤</span>
      <span class="busuanzi-label">æœ¬ç«™è®¿å®¢æ•°</span>
      <span id="busuanzi_value_site_uv" class="busuanzi-value">0</span>
      <span class="busuanzi-unit">äºº</span>
    </span>
    
    <span class="busuanzi-separator">|</span>
    
    <span id="busuanzi_container_page_pv" class="busuanzi-stat">
      <span class="busuanzi-icon">ğŸ“„</span>
      <span class="busuanzi-label">æœ¬é¡µè®¿é—®é‡</span>
      <span id="busuanzi_value_page_pv" class="busuanzi-value">0</span>
      <span class="busuanzi-unit">æ¬¡</span>
    </span>
    
    {% if site.components.busuanzi.start_date %}
    <span class="busuanzi-separator">|</span>
    <span class="busuanzi-stat">
      <span class="busuanzi-icon">ğŸ“…</span>
      <span class="busuanzi-label">ç»Ÿè®¡å§‹äº</span>
      <span class="busuanzi-date">{{ site.components.busuanzi.start_date }}</span>
    </span>
    {% endif %}
  </div>
</div>

<style>
/* è®¿é—®ç»Ÿè®¡å®¹å™¨æ ·å¼ */
.busuanzi-counter-container {
  position: fixed;
  bottom: 0;
  left: 0;
  width: 100%;
  background: linear-gradient(135deg, rgba(255, 240, 245, 0.95), rgba(255, 250, 251, 0.95));
  backdrop-filter: blur(5px);
  border-top: 1px solid rgba(255, 182, 193, 0.3);
  box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.05);
  z-index: 9998;
  padding: 8px 0;
  transition: all 0.3s ease;
}

/* å†…å®¹å±…ä¸­ */
.busuanzi-counter-content {
  display: flex;
  justify-content: center;
  align-items: center;
  flex-wrap: wrap;
  gap: 8px;
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 20px;
  font-size: 0.8rem;
  color: #666;
}

/* ç»Ÿè®¡é¡¹æ ·å¼ */
.busuanzi-stat {
  display: flex;
  align-items: center;
  gap: 5px;
  padding: 3px 8px;
  background: rgba(255, 255, 255, 0.6);
  border-radius: 12px;
  border: 1px solid rgba(255, 182, 193, 0.2);
  transition: all 0.3s ease;
}

.busuanzi-stat:hover {
  background: rgba(255, 255, 255, 0.9);
  transform: translateY(-1px);
  box-shadow: 0 3px 8px rgba(255, 182, 193, 0.2);
}

/* å›¾æ ‡æ ·å¼ */
.busuanzi-icon {
  font-size: 0.9rem;
  opacity: 0.8;
}

/* æ ‡ç­¾æ ·å¼ */
.busuanzi-label {
  color: #888;
  white-space: nowrap;
}

/* æ•°å€¼æ ·å¼ */
.busuanzi-value {
  color: #ff6b9d;
  font-weight: bold;
  font-family: 'Courier New', monospace;
  min-width: 20px;
  text-align: center;
}

/* å•ä½æ ·å¼ */
.busuanzi-unit {
  color: #87ceeb;
  font-size: 0.75rem;
}

/* æ—¥æœŸæ ·å¼ */
.busuanzi-date {
  color: #4cd964;
  font-weight: 500;
}

/* åˆ†éš”ç¬¦ */
.busuanzi-separator {
  color: #ddd;
  opacity: 0.5;
  padding: 0 2px;
  user-select: none;
}

/* å“åº”å¼è®¾è®¡ */
@media (max-width: 768px) {
  .busuanzi-counter-content {
    font-size: 0.7rem;
    padding: 0 10px;
    gap: 5px;
  }
  
  .busuanzi-stat {
    padding: 2px 6px;
  }
  
  .busuanzi-label {
    display: none; /* åœ¨æ‰‹æœºä¸Šéšè—æ ‡ç­¾ï¼Œåªæ˜¾ç¤ºå›¾æ ‡å’Œæ•°å€¼ */
  }
  
  .busuanzi-unit {
    font-size: 0.7rem;
  }
  
  .busuanzi-separator {
    display: none; /* åœ¨æ‰‹æœºä¸Šéšè—åˆ†éš”ç¬¦ */
  }
  
  /* åœ¨æ‰‹æœºä¸Šæ˜¾ç¤ºä¸ºä¸¤è¡Œ */
  .busuanzi-counter-content {
    flex-direction: column;
    align-items: center;
    gap: 5px;
  }
  
  .busuanzi-counter-container {
    padding: 6px 0;
  }
}

@media (max-width: 480px) {
  .busuanzi-counter-content {
    font-size: 0.65rem;
  }
  
  .busuanzi-stat {
    flex: 1;
    justify-content: center;
    min-width: 100px;
  }
  
  .busuanzi-counter-container {
    position: static; /* åœ¨éå¸¸å°çš„å±å¹•ä¸Šæ”¹ä¸ºé™æ€å®šä½ */
  }
}

/* æ‰“å°æ—¶éšè— */
@media print {
  .busuanzi-counter-container {
    display: none;
  }
}
</style>

<script>
// æ·»åŠ æ•°å€¼å˜åŒ–åŠ¨ç”»
document.addEventListener('DOMContentLoaded', function() {
  // æ£€æŸ¥ä¸è’œå­æ˜¯å¦åŠ è½½æˆåŠŸ
  setTimeout(function() {
    const stats = [
      { id: 'busuanzi_value_site_pv', target: 0 },
      { id: 'busuanzi_value_site_uv', target: 0 },
      { id: 'busuanzi_value_page_pv', target: 0 }
    ];
    
    stats.forEach(stat => {
      const element = document.getElementById(stat.id);
      if (element) {
        const currentValue = parseInt(element.textContent) || 0;
        
        // å¦‚æœå€¼å¤§äº0ï¼Œæ·»åŠ å¢é•¿åŠ¨ç”»
        if (currentValue > 0) {
          element.style.transform = 'scale(1.1)';
          element.style.color = '#ff1493';
          element.style.transition = 'all 0.3s ease';
          
          setTimeout(() => {
            element.style.transform = 'scale(1)';
            element.style.color = '#ff6b9d';
          }, 300);
        }
      }
    });
  }, 1000);
});

// é¼ æ ‡æ‚¬åœæ—¶æå‡å±‚çº§
document.querySelectorAll('.busuanzi-stat').forEach(stat => {
  stat.addEventListener('mouseenter', function() {
    this.style.zIndex = '10000';
  });
  
  stat.addEventListener('mouseleave', function() {
    this.style.zIndex = '';
  });
});
</script>

{% endif %}
